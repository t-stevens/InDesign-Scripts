    var myFolder = Folder.selectDialog( "Select a folder with InDesign files" );        if ( myFolder != null ) {             var myFiles = [];                          GetSubFolders(myFolder);        }                //=================================== FUNCTIONS =========================================        function GetSubFolders(theFolder) {             var myFileList = theFolder.getFiles();             for (var i = 0; i < myFileList.length; i++) {                  var myFile = myFileList[i];                  if (myFile instanceof Folder){                       GetSubFolders(myFile);                  }                  else if (myFile instanceof File && myFile.name.match(/\.indd$/i)) {                       myFiles.push(myFile);                  }             }        }   var badFamily = [];var badStyle = [];     for (var i = 0; i < myFiles.length; i++) {             myFile = myFiles[i];           app.scriptPreferences.userInteractionLevel = UserInteractionLevels.NEVER_INTERACT;           doc = app.open(myFile, false);         app.scriptPreferences.userInteractionLevel = UserInteractionLevels.INTERACT_WITH_ALL;           var docRef = app.documents.item(0);         var myDoc = app.documents[0];         UnassignEmptyFrames(myDoc);         var myDocFonts = myDoc.fonts;        for(var f = 0; f < myDocFonts.length; f++){            fFamily = myDocFonts[f].fontFamily;            fStyle = myDocFonts[f].fontStyleName;            //$.writeln(fFamily);            //$.writeln(fStyle);            if(fFamily.search('lds') == -1){                badFamily.push(fFamily);                badStyle.push(fStyle);            }        }        for(var j = 0; j < badFamily.length; j++){            app.findTextPreferences = app.changeTextPreferences = null;              app.findTextPreferences.appliedFont = badFamily[j];             app.findTextPreferences.fontStyle = badStyle[j];            app.changeTextPreferences.appliedFont = "Palatino ldsLat";            app.changeTextPreferences.fontStyle = "Roman";            app.findChangeTextOptions.includeFootnotes = true;            app.findChangeTextOptions.includeMasterPages = false;            app.findChangeTextOptions.includeHiddenLayers = false;            app.findChangeTextOptions.wholeWord = true;            var myFoundItems = docRef.findText();            var fontTest = app.fonts.itemByName(badFamily[j] + "\t" + badFamily[j]).status;            var myTest = app.fonts.itemByName("Palatino ldsLat\tRoman").status;//space is a tab            if (myFoundItems != "" && myTest == 1718831470){ //INSTALLED                docRef.changeText();             }        }app.findTextPreferences.appliedFont= app.changeTextPreferences = null;         doc.close(SaveOptions.YES);      }   //fix empty framesfunction UnassignEmptyFrames(myDoc){    var s = myDoc.stories;    for(var i = 0; i < s.length; i++){        var sText = s[i].textContainers;        for(var j = 0; j < sText.length; j++){            if(sText[j].contents === ""){                try{                sText[j].contentType = ContentType.UNASSIGNED;                }                catch(e){}                }            }        }}