var myDoc = app.activeDocument;var dmDoc = myDoc.dataMergeProperties;var excelFile = File.openDialog("Select source file");main();function main() {	//Set all find/change preferences	app.findGrepPreferences = app.changeGrepPreferences = null;	app.findChangeGrepOptions.includeFootnotes = false;	app.findChangeGrepOptions.includeHiddenLayers = false;	app.findChangeGrepOptions.includeLockedLayersForFind = false;	app.findChangeGrepOptions.includeLockedStoriesForFind = false;	app.findChangeGrepOptions.includeMasterPages = true;		app.findGrepPreferences.findWhat = '##[\\l\\u ]+##';	app.changeGrepPreferences.changeTo = '';	//END set all find/change preferences		var s =[];	var ip =[];	var c =[];	var texts = myDoc.findGrep();			for (var i = 0; i < texts.length; i++) {		s.push(texts[i].parentStory);		ip.push(texts[i].insertionPoints[0]);		c.push(texts[i]);	}		//dataMerge placeholders	var d = myDoc.dataMergeTextPlaceholders;		if (d.length == 0) {		alert('Data merge placeholders must be placed into the document before running this script.');		return;	}	var t, tName, x, temp;		for (var j = d.length -1; j >= 0; j--) {		t = d[j].field;		tName = t.fieldName;		temp = '##' + tName + '##';		for (var k = 0; k < c.length; k++) {			if (temp == c[k].contents) {                                try{				x = d.add(s[k], ip[k], t);                c[k].contents = '';                break;                }            catch(e){$.writeln(c[k]);}			}		}	}		clear = myDoc.findGrep();	//app.activeDocument.changeGrep();	app.findGrepPreferences = app.changeGrepPreferences = null;    doMerge();}function doMerge() {	dmDoc.selectDataSource(excelFile);	dmDoc.mergeRecords();    }